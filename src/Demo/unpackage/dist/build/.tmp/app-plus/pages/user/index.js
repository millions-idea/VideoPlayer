(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/index"],{"216b":function(n,e,t){"use strict";t.r(e);var o=t("d4e5"),s=t("7f8e");for(var i in s)"default"!==i&&function(n){t.d(e,n,function(){return s[n]})}(i);t("4f66");var a=t("2877"),c=Object(a["a"])(s["default"],o["a"],o["b"],!1,null,null,null);e["default"]=c.exports},"4f66":function(n,e,t){"use strict";var o=t("abf9"),s=t.n(o);s.a},"7f8e":function(n,e,t){"use strict";t.r(e);var o=t("c295"),s=t.n(o);for(var i in o)"default"!==i&&function(n){t.d(e,n,function(){return o[n]})}(i);e["default"]=s.a},abf9:function(n,e,t){},c295:function(n,e,t){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=t("2f62");function s(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},o=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),o.forEach(function(e){i(n,e,t[e])})}return n}function i(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var a=function(){return t.e("components/uni-grid/uni-grid.user").then(t.bind(null,"fec2"))},c=function(){return t.e("components/lazy-image-user").then(t.bind(null,"2143"))},u={components:{uniGrid:a,lazyImage:c},data:function(){return{wallet:{balance:"0.00",account:"0.00",playCount:"0",consumeCount:"0.00"},yabo:{money:"0.00"},isShow:!1,avatar:"../../static/user/default-avatar.png",balance:"0.00",account:"0.00",playCount:"0",consumeCount:"0.00",yaboMoney:"0.00",shakeAnimation:"",show:!1}},created:function(){this.appEvents.$on("onPasswordDone",this.onPasswordDone)},destroyed:function(){this.appEvents.$off("onPasswordDone")},computed:s({},(0,o.mapState)(["hasLogin","profile"]),{isLogin:function(){return this.hasLogin},previewHeight:function(){if(!this.hasLogin)return n.upx2px(57750/414)+"px"},queryNickName:function(){return null==this.profile.account||this.profile.account.length<1?"请您先登录":this.profile.nickName}}),methods:s({},(0,o.mapActions)(["setProfile","authOpenWindow"]),{toAgentLink:function(){this.common.window.toNew("article/list",null)},toYaboLink:function(){this.common.window.toNew("generics-webview/generics-webview",{url:this.profile.yaboUrl})},queryAsserts:function(){var e=this;this.$api.get("api/user/getAssetSample",{}).then(function(t){n.stopPullDownRefresh(),200==t.data.code&&(e.wallet.balance=t.data.msg.balance,e.wallet.account=t.data.msg.account,e.wallet.playCount=t.data.msg.playCount,e.wallet.consumeCount=t.data.msg.consumeCount)}),void 0==(this.profile.yabo,!1)?e.yabo.money=this.profile.yabo.data.money:e.yabo.money="0.00"},refreshInfo:function(){var e=this;this.session.clearSession(),this.session.clearState();var t=this.session.getSession();if(null==t){console.log("加载用户信息"," at pages\\user\\index.vue:195");var o=this;this.$api.post("api/user/getProfile",{}).then(function(t){n.stopPullDownRefresh(),o.common.Response.isFaild(t.data)||(o.common.Response.isException(t.data)?-1==t.data.msg.indexOf("冻结")&&-1==t.data.msg.indexOf("null")||(-1!=t.data.msg.indexOf("null")&&(t.data.msg="请重新登录"),n.showModal({title:"强制退出通知",content:t.data.msg,showCancel:!1,cancelText:"",confirmText:"",success:function(t){e.session.clear(),e.session.removeValue("token"),e.sysLogout(),setTimeout(function(){n.hideLoading(),n.reLaunch({url:"./bootstrap/login"})},1e3)},fail:function(){},complete:function(){}})):(o.session.setSession(t.data.msg),o.setProfile(t.data.msg)))}).catch(function(n){})}else n.stopPullDownRefresh(),console.log("更新用户信息"," at pages\\user\\index.vue:242"),_self.setProfile(t);this.queryAsserts()},updatePassword:function(){this.common.window.toNew("generics-form/generics-form",{formName:"Password",title:"修改登录密码",topLabel:"需要接收短信验证码进行身份验证",bottomLabel:"为确保您账户的安全及正常使用，依《网络安全法》相关要求，6月1日起会员账户需绑定手机。如您还未绑定，请尽快完成，感谢您的理解及支持！ ",placeholder:"请输入新的登录密码",maxLength:128,minLength:6,success:"onPasswordDone",type:"password"})},onPasswordDone:function(e){var t=this;if(1==this.tapHz)return n.showToast({title:"操作过于频繁",icon:"none"}),void setTimeout(function(){t.tapHz=0},1e4);n.showLoading({title:"请稍后",icon:"none"}),this.tapHz=1,this.$api.get("api/user/sendPasswordSmsCode",{phone:this.profile.phone}).then(function(o){n.hideLoading(),t.tapHz=0,t.common.Response.isFaild(o.data)?n.showToast({title:"获取验证码失败",icon:"none"}):t.common.Response.isException(o.data)?n.showToast({title:o.data.msg,icon:"none"}):t.common.window.toNew("generics-sms/generics-sms",{formName:"Password",phone:t.profile.phone,ext:JSON.stringify({password:e}),success:"onSmsPasswordDone",reTry:"onReSendPasswordSmsCode"})})},toggleBalance:function(){this.isShow?(this.isShow=!1,this.wallet.balance=this.balance,this.wallet.account=this.account,this.wallet.playCount=this.playCount,this.wallet.consumeCount=this.consumeCount):(this.isShow=!0,this.balance=this.wallet.balance,this.account=this.wallet.account,this.playCount=this.wallet.playCount,this.consumeCount=this.wallet.consumeCount,this.wallet.balance="....",this.wallet.account="....",this.wallet.playCount="....",this.wallet.consumeCount="....")},shakeAndTo:function(){var n=this;this.shakeAnimation="bounceIn",setTimeout(function(){n.shakeAnimation="",n.common.window.toNew("user/index/profile",null)},100)},buyVip:function(){var e=this;if(this.hasLogin){if(n.showLoading({title:"请稍后",mask:!1}),this.profile.isVip)return n.hideLoading(),void n.showToast({title:"您已经是VIP会员啦",icon:"none"});this.$api.get("api/user/getVipOrderInfo",{}).then(function(t){n.hideLoading(),e.common.Response.isFaild(t.data)?n.showToast({title:"拉取服务器信息超时",icon:"none"}):e.common.Response.isException(t.data)?n.showToast({title:t.data.msg,icon:"none"}):e.common.window.toNew("user/order/payment",t.data.msg)})}else this.common.window.toNew("user/bootstrap/login",null)},vipTip:function(){n.showToast({title:"尊敬的VIP会员您好!",icon:"none",duration:3e3})},showBanner:function(){this.show=!0},closeBanner:function(){this.show=!1},tap:function(){},finance:function(){this.authOpenWindow("user/finance")},onClick:function(n){switch(n.index){case 0:this.authOpenWindow("user/history");break;case 1:this.authOpenWindow("user/collect");break;case 2:this.authOpenWindow("user/shopping");break;case 3:this.common.window.toNew("generics-webview/generics-webview",{url:this.profile.yaboUrl});break}}}),onLoad:function(){this.refreshInfo()},onShow:function(){n.startPullDownRefresh()},onPullDownRefresh:function(){console.log("onPullDownRefresh"," at pages\\user\\index.vue:433"),this.refreshInfo()}};e.default=u}).call(this,t("6e42")["default"])},d4e5:function(n,e,t){"use strict";var o=function(){var n=this,e=n.$createElement;n._self._c},s=[];t.d(e,"a",function(){return o}),t.d(e,"b",function(){return s})}},[["fec5","common/runtime","common/vendor"]]]);