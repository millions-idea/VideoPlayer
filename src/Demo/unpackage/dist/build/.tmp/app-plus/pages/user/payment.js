(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/payment"],{"04f2":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c},o=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o})},"0943":function(e,t,n){},"36ab":function(e,t,n){"use strict";n.r(t);var i=n("befb"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);t["default"]=o.a},aacc:function(e,t,n){"use strict";n.r(t);var i=n("04f2"),o=n("36ab");for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);n("f011");var s=n("2877"),c=Object(s["a"])(o["default"],i["a"],i["b"],!1,null,"0d0eff2d",null);t["default"]=c.exports},befb:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("2f62");function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){a(e,t,n[t])})}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){return n.e("components/mht-loader/mht-loader").then(n.bind(null,"e0d5"))},c=function(){return n.e("graceUI/components/graceSafeyNumberKeyboard").then(n.bind(null,"f37f"))},r=function(){return n.e("components/uni-notice-bar/uni-notice-bar").then(n.bind(null,"6a7b"))},h={name:"generics-sms",data:function(){return{title:"",graceNumberKeyboardShow:!0,numberVal:"",activeIndex:0,codes:["","","","","",""],password:"",callback:""}},computed:o({},(0,i.mapState)(["hasLogin","profile"]),{isActive1:function(){return 0==this.activeIndex},isActive2:function(){return 1==this.activeIndex},isActive3:function(){return 2==this.activeIndex},isActive4:function(){return 3==this.activeIndex},isActive5:function(){return 4==this.activeIndex},isActive6:function(){return 5==this.activeIndex},getTitle:function(){return null==this.title||0==this.title.length?"设置支付密码":this.title}}),components:{mhtLoader:s,graceSafeyNumberKeyboard:c,uniNoticeBar:r},onLoad:function(t){this.title=t.title,this.callback=t.callback,e.hideKeyboard()},onShow:function(){this.activeIndex=0,this.graceNumberKeyboardShow=!0,e.hideKeyboard()},created:function(){var t=this;this.appEvents.$on("close__payment",function(){e.navigateBack({delta:t.delta})}),this.appEvents.$on("close__Password",function(){e.navigateBack({delta:t.delta})}),this.appEvents.$on("onSMSpaymentDone",this.onSMSpaymentDone),this.appEvents.$on("onReSendSmsCode",this.onReSendSmsCode)},destroyed:function(){this.appEvents.$off("close__payment"),this.appEvents.$off("onSMSpaymentDone"),this.appEvents.$off("onReSendSmsCode"),null!=this.callback&&this.callback.length>0&&this.appEvents.$off(this.callback)},methods:o({},(0,i.mapActions)(["setProfile","login"]),{showKeyboard:function(){this.graceNumberKeyboardShow=!0,e.hideKeyboard()},keyboardInput:function(e){var t=this,n=this.numberVal+""+e+",",i=n.split(",");if(n.length>=12){var o=0;return this.codes.forEach(function(e){0!=e.length&&""!=e||o++}),0!=o&&(this.codes[this.codes.length-1]=e),this.codes.length<6&&this.codes.push(e),void this.keyboardDone()}this.numberVal=n,i.forEach(function(e,n){1==e.length&&(t.codes[n]=e)}),i.length>1&&i.length<=6&&(this.activeIndex=i.length-1),this.activeIndex--},keyboardDelete:function(){if(this.activeIndex<0)this.activeIndex=0;else{var e=this.numberVal.split(",");e.length<=0||(this.activeIndex=e.length-1,this.numberVal=this.numberVal.substring(0,this.numberVal.length-2),this.codes[this.activeIndex-1]="",1==this.activeIndex?this.activeIndex=this.activeIndex-1:this.activeIndex>0&&(this.activeIndex=this.activeIndex-2))}},keyboardDone:function(){var t=this,n="";if(this.codes.forEach(function(e){return n+=e}),6==n.length)return e.showLoading({title:"请稍后",icon:"none"}),this.graceNumberKeyboardShow=!1,this.codes=[],this.activeIndex=0,this.numberVal="",this.password=n,null!=this.callback&&this.callback.length>0?(e.hideLoading(),void this.appEvents.$emit(this.callback,this.password)):void this.$api.get("api/user/sendPaymentSmsCode",{phone:this.profile.phone}).then(function(n){e.hideLoading(),t.common.Response.isFaild(n.data)?e.showToast({title:"获取验证码失败",icon:"none"}):t.common.Response.isException(n.data)?e.showToast({title:n.data.msg,icon:"none"}):t.common.window.toNew("generics-sms/generics-sms",{formName:"payment",phone:t.profile.phone,success:"onSMSpaymentDone",reTry:"onReSendSmsCode"})})},onReSendSmsCode:function(t){var n=this;this.$api.get("api/user/sendPaymentSmsCode",{phone:this.profile.phone}).then(function(t){n.common.Response.isFaild(t.data)?e.showToast({title:"获取验证码失败",icon:"none"}):n.common.Response.isException(t.data)&&e.showToast({title:t.data.msg,icon:"none"})})},onSMSpaymentDone:function(t){var n=t.split(","),i=this;this.$api.post("api/user/changePaymentPassword",{smsCode:n[1],password:this.password}).then(function(t){i.common.Response.isFaild(t.data)?e.showToast({title:"获取验证码失败",icon:"none"}):i.common.Response.isException(t.data)?e.showToast({title:t.data.msg,icon:"none"}):(e.showToast({icon:"none",title:"密码修改成功"}),setTimeout(function(){e.navigateBack({delta:2})},2e3))})},onPassSMSVerifyDone:function(t){e.showToast({icon:"none",title:"绑定成功"}),setTimeout(function(){e.navigateBack({delta:2})},2e3)}})};t.default=h}).call(this,n("6e42")["default"])},f011:function(e,t,n){"use strict";var i=n("0943"),o=n.n(i);o.a}},[["a31a","common/runtime","common/vendor"]]]);